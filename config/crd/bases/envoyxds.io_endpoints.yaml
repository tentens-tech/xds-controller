---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.4
  name: endpoints.envoyxds.io
spec:
  group: envoyxds.io
  names:
    kind: Endpoint
    listKind: EndpointList
    plural: endpoints
    singular: endpoint
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Cluster name for the endpoint
      jsonPath: .spec.cluster_name
      name: ClusterName
      type: string
    - description: Whether the endpoint is active
      jsonPath: .status.active
      name: Active
      type: boolean
    - description: Number of endpoints
      jsonPath: .status.endpointCount
      name: Endpoints
      type: integer
    - description: Status message
      jsonPath: .status.message
      name: Status
      type: string
    - description: Nodes where endpoint is deployed
      jsonPath: .status.nodes
      name: Nodes
      type: string
    - description: Clusters where endpoint is deployed
      jsonPath: .status.clusters
      name: Clusters
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Endpoint is the Schema for the endpoints API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: EndpointSpec defines the desired state of Endpoint
            properties:
              cluster_name:
                type: string
              endpoints:
                items:
                  description: LocalityLbEndpoints represents the Envoy LocalityLbEndpoints
                    configuration.
                  properties:
                    lb_endpoints:
                      items:
                        description: LbEndpoint represents the Envoy LbEndpoint configuration.
                        properties:
                          endpoint:
                            description: Endpoint represents the Envoy Endpoint configuration.
                            properties:
                              additional_addresses:
                                items:
                                  description: Endpoint_AdditionalAddress represents
                                    the Envoy Endpoint_AdditionalAddress configuration.
                                  properties:
                                    address:
                                      description: Address represents the Envoy Address
                                        configuration.
                                      properties:
                                        envoy_internal_address:
                                          description: EnvoyInternalAddress represents
                                            the Envoy EnvoyInternalAddress configuration.
                                          properties:
                                            endpoint_id:
                                              type: string
                                            server_listener_name:
                                              type: string
                                          type: object
                                        pipe:
                                          description: Pipe represents the Envoy Pipe
                                            configuration.
                                          properties:
                                            mode:
                                              format: int32
                                              type: integer
                                            path:
                                              type: string
                                          type: object
                                        socket_address:
                                          description: SocketAddress represents the
                                            Envoy SocketAddress configuration.
                                          properties:
                                            address:
                                              type: string
                                            ipv4_compat:
                                              type: boolean
                                            named_port:
                                              type: string
                                            network_namespace_filepath:
                                              type: string
                                            port_value:
                                              format: int32
                                              type: integer
                                            protocol:
                                              description: SocketAddress_Protocol
                                                is an enum type.
                                              type: string
                                            resolver_name:
                                              type: string
                                          type: object
                                      type: object
                                  type: object
                                type: array
                              address:
                                description: Address represents the Envoy Address
                                  configuration.
                                properties:
                                  envoy_internal_address:
                                    description: EnvoyInternalAddress represents the
                                      Envoy EnvoyInternalAddress configuration.
                                    properties:
                                      endpoint_id:
                                        type: string
                                      server_listener_name:
                                        type: string
                                    type: object
                                  pipe:
                                    description: Pipe represents the Envoy Pipe configuration.
                                    properties:
                                      mode:
                                        format: int32
                                        type: integer
                                      path:
                                        type: string
                                    type: object
                                  socket_address:
                                    description: SocketAddress represents the Envoy
                                      SocketAddress configuration.
                                    properties:
                                      address:
                                        type: string
                                      ipv4_compat:
                                        type: boolean
                                      named_port:
                                        type: string
                                      network_namespace_filepath:
                                        type: string
                                      port_value:
                                        format: int32
                                        type: integer
                                      protocol:
                                        description: SocketAddress_Protocol is an
                                          enum type.
                                        type: string
                                      resolver_name:
                                        type: string
                                    type: object
                                type: object
                              health_check_config:
                                description: Endpoint_HealthCheckConfig represents
                                  the Envoy Endpoint_HealthCheckConfig configuration.
                                properties:
                                  address:
                                    description: Address represents the Envoy Address
                                      configuration.
                                    properties:
                                      envoy_internal_address:
                                        description: EnvoyInternalAddress represents
                                          the Envoy EnvoyInternalAddress configuration.
                                        properties:
                                          endpoint_id:
                                            type: string
                                          server_listener_name:
                                            type: string
                                        type: object
                                      pipe:
                                        description: Pipe represents the Envoy Pipe
                                          configuration.
                                        properties:
                                          mode:
                                            format: int32
                                            type: integer
                                          path:
                                            type: string
                                        type: object
                                      socket_address:
                                        description: SocketAddress represents the
                                          Envoy SocketAddress configuration.
                                        properties:
                                          address:
                                            type: string
                                          ipv4_compat:
                                            type: boolean
                                          named_port:
                                            type: string
                                          network_namespace_filepath:
                                            type: string
                                          port_value:
                                            format: int32
                                            type: integer
                                          protocol:
                                            description: SocketAddress_Protocol is
                                              an enum type.
                                            type: string
                                          resolver_name:
                                            type: string
                                        type: object
                                    type: object
                                  disable_active_health_check:
                                    type: boolean
                                  hostname:
                                    type: string
                                  port_value:
                                    format: int32
                                    type: integer
                                type: object
                              hostname:
                                type: string
                            type: object
                          endpoint_name:
                            type: string
                          health_status:
                            description: HealthStatus is an enum type.
                            type: string
                          load_balancing_weight:
                            format: int32
                            type: integer
                          metadata:
                            description: Metadata represents the Envoy Metadata configuration.
                            properties:
                              filter_metadata:
                                additionalProperties:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                                type: object
                                x-kubernetes-preserve-unknown-fields: true
                              typed_filter_metadata:
                                additionalProperties:
                                  type: object
                                  x-kubernetes-preserve-unknown-fields: true
                                type: object
                                x-kubernetes-preserve-unknown-fields: true
                            type: object
                        type: object
                      type: array
                    leds_cluster_locality_config:
                      description: LedsClusterLocalityConfig represents the Envoy
                        LedsClusterLocalityConfig configuration.
                      properties:
                        leds_collection_name:
                          type: string
                        leds_config:
                          description: ConfigSource represents the Envoy ConfigSource
                            configuration.
                          properties:
                            ads:
                              type: object
                              x-kubernetes-preserve-unknown-fields: true
                            api_config_source:
                              description: ApiConfigSource represents the Envoy ApiConfigSource
                                configuration.
                              properties:
                                api_type:
                                  description: ApiConfigSource_ApiType is an enum
                                    type.
                                  type: string
                                cluster_names:
                                  items:
                                    type: string
                                  type: array
                                config_validators:
                                  items:
                                    description: TypedExtensionConfig represents the
                                      Envoy TypedExtensionConfig configuration.
                                    properties:
                                      name:
                                        type: string
                                      typed_config:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                    type: object
                                  type: array
                                grpc_services:
                                  items:
                                    description: GrpcService represents the Envoy
                                      GrpcService configuration.
                                    properties:
                                      envoy_grpc:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                      from_plugin:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                      google_grpc:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                      initial_metadata:
                                        items:
                                          description: HeaderValue represents the
                                            Envoy HeaderValue configuration.
                                          properties:
                                            key:
                                              type: string
                                            raw_value:
                                              format: byte
                                              type: string
                                            value:
                                              type: string
                                          type: object
                                        type: array
                                      int_value:
                                        format: int64
                                        type: integer
                                      local_credentials:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                      retry_policy:
                                        description: RetryPolicy represents the Envoy
                                          RetryPolicy configuration.
                                        properties:
                                          host_selection_retry_max_attempts:
                                            format: int64
                                            type: integer
                                          num_retries:
                                            format: int32
                                            type: integer
                                          retry_back_off:
                                            description: BackoffStrategy represents
                                              the Envoy BackoffStrategy configuration.
                                            properties:
                                              base_interval:
                                                type: string
                                              max_interval:
                                                type: string
                                            type: object
                                          retry_host_predicate:
                                            items:
                                              description: RetryPolicy_RetryHostPredicate
                                                represents the Envoy RetryPolicy_RetryHostPredicate
                                                configuration.
                                              properties:
                                                name:
                                                  type: string
                                                typed_config:
                                                  type: object
                                                  x-kubernetes-preserve-unknown-fields: true
                                              type: object
                                            type: array
                                          retry_on:
                                            type: string
                                          retry_priority:
                                            description: RetryPolicy_RetryPriority
                                              represents the Envoy RetryPolicy_RetryPriority
                                              configuration.
                                            properties:
                                              name:
                                                type: string
                                              typed_config:
                                                type: object
                                                x-kubernetes-preserve-unknown-fields: true
                                            type: object
                                        type: object
                                      ssl_credentials:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                      string_value:
                                        type: string
                                      sts_service:
                                        type: object
                                        x-kubernetes-preserve-unknown-fields: true
                                      timeout:
                                        type: string
                                    type: object
                                  type: array
                                rate_limit_settings:
                                  description: RateLimitSettings represents the Envoy
                                    RateLimitSettings configuration.
                                  properties:
                                    fill_rate:
                                      type: number
                                    max_tokens:
                                      format: int32
                                      type: integer
                                  type: object
                                refresh_delay:
                                  type: string
                                request_timeout:
                                  type: string
                                set_node_on_first_message_only:
                                  type: boolean
                                transport_api_version:
                                  description: ApiVersion is an enum type.
                                  type: string
                              type: object
                            initial_fetch_timeout:
                              type: string
                            path:
                              type: string
                            path_config_source:
                              description: PathConfigSource represents the Envoy PathConfigSource
                                configuration.
                              properties:
                                path:
                                  type: string
                                watched_directory:
                                  description: WatchedDirectory represents the Envoy
                                    WatchedDirectory configuration.
                                  properties:
                                    path:
                                      type: string
                                  type: object
                              type: object
                            resource_api_version:
                              description: ApiVersion is an enum type.
                              type: string
                            self:
                              description: SelfConfigSource represents the Envoy SelfConfigSource
                                configuration.
                              properties:
                                transport_api_version:
                                  description: ApiVersion is an enum type.
                                  type: string
                              type: object
                          type: object
                      type: object
                    load_balancer_endpoints:
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                    load_balancing_weight:
                      format: int32
                      type: integer
                    locality:
                      description: Locality represents the Envoy Locality configuration.
                      properties:
                        region:
                          type: string
                        sub_zone:
                          type: string
                        zone:
                          type: string
                      type: object
                    metadata:
                      description: Metadata represents the Envoy Metadata configuration.
                      properties:
                        filter_metadata:
                          additionalProperties:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                        typed_filter_metadata:
                          additionalProperties:
                            type: object
                            x-kubernetes-preserve-unknown-fields: true
                          type: object
                          x-kubernetes-preserve-unknown-fields: true
                      type: object
                    priority:
                      format: int32
                      type: integer
                    proximity:
                      format: int32
                      type: integer
                  type: object
                type: array
              named_endpoints:
                additionalProperties:
                  description: Endpoint represents the Envoy Endpoint configuration.
                  properties:
                    additional_addresses:
                      items:
                        description: Endpoint_AdditionalAddress represents the Envoy
                          Endpoint_AdditionalAddress configuration.
                        properties:
                          address:
                            description: Address represents the Envoy Address configuration.
                            properties:
                              envoy_internal_address:
                                description: EnvoyInternalAddress represents the Envoy
                                  EnvoyInternalAddress configuration.
                                properties:
                                  endpoint_id:
                                    type: string
                                  server_listener_name:
                                    type: string
                                type: object
                              pipe:
                                description: Pipe represents the Envoy Pipe configuration.
                                properties:
                                  mode:
                                    format: int32
                                    type: integer
                                  path:
                                    type: string
                                type: object
                              socket_address:
                                description: SocketAddress represents the Envoy SocketAddress
                                  configuration.
                                properties:
                                  address:
                                    type: string
                                  ipv4_compat:
                                    type: boolean
                                  named_port:
                                    type: string
                                  network_namespace_filepath:
                                    type: string
                                  port_value:
                                    format: int32
                                    type: integer
                                  protocol:
                                    description: SocketAddress_Protocol is an enum
                                      type.
                                    type: string
                                  resolver_name:
                                    type: string
                                type: object
                            type: object
                        type: object
                      type: array
                    address:
                      description: Address represents the Envoy Address configuration.
                      properties:
                        envoy_internal_address:
                          description: EnvoyInternalAddress represents the Envoy EnvoyInternalAddress
                            configuration.
                          properties:
                            endpoint_id:
                              type: string
                            server_listener_name:
                              type: string
                          type: object
                        pipe:
                          description: Pipe represents the Envoy Pipe configuration.
                          properties:
                            mode:
                              format: int32
                              type: integer
                            path:
                              type: string
                          type: object
                        socket_address:
                          description: SocketAddress represents the Envoy SocketAddress
                            configuration.
                          properties:
                            address:
                              type: string
                            ipv4_compat:
                              type: boolean
                            named_port:
                              type: string
                            network_namespace_filepath:
                              type: string
                            port_value:
                              format: int32
                              type: integer
                            protocol:
                              description: SocketAddress_Protocol is an enum type.
                              type: string
                            resolver_name:
                              type: string
                          type: object
                      type: object
                    health_check_config:
                      description: Endpoint_HealthCheckConfig represents the Envoy
                        Endpoint_HealthCheckConfig configuration.
                      properties:
                        address:
                          description: Address represents the Envoy Address configuration.
                          properties:
                            envoy_internal_address:
                              description: EnvoyInternalAddress represents the Envoy
                                EnvoyInternalAddress configuration.
                              properties:
                                endpoint_id:
                                  type: string
                                server_listener_name:
                                  type: string
                              type: object
                            pipe:
                              description: Pipe represents the Envoy Pipe configuration.
                              properties:
                                mode:
                                  format: int32
                                  type: integer
                                path:
                                  type: string
                              type: object
                            socket_address:
                              description: SocketAddress represents the Envoy SocketAddress
                                configuration.
                              properties:
                                address:
                                  type: string
                                ipv4_compat:
                                  type: boolean
                                named_port:
                                  type: string
                                network_namespace_filepath:
                                  type: string
                                port_value:
                                  format: int32
                                  type: integer
                                protocol:
                                  description: SocketAddress_Protocol is an enum type.
                                  type: string
                                resolver_name:
                                  type: string
                              type: object
                          type: object
                        disable_active_health_check:
                          type: boolean
                        hostname:
                          type: string
                        port_value:
                          format: int32
                          type: integer
                      type: object
                    hostname:
                      type: string
                  type: object
                type: object
              policy:
                description: ClusterLoadAssignment_Policy represents the Envoy ClusterLoadAssignment_Policy
                  configuration.
                properties:
                  drop_overloads:
                    items:
                      description: ClusterLoadAssignment_Policy_DropOverload represents
                        the Envoy ClusterLoadAssignment_Policy_DropOverload configuration.
                      properties:
                        category:
                          type: string
                        drop_percentage:
                          description: FractionalPercent represents the Envoy FractionalPercent
                            configuration.
                          properties:
                            denominator:
                              description: FractionalPercent_DenominatorType is an
                                enum type.
                              type: string
                            numerator:
                              format: int32
                              type: integer
                          type: object
                      type: object
                    type: array
                  endpoint_stale_after:
                    type: string
                  overprovisioning_factor:
                    format: int32
                    type: integer
                  weighted_priority_health:
                    type: boolean
                type: object
            type: object
          status:
            description: EndpointStatus defines the observed state of Endpoint
            properties:
              active:
                description: Active indicates if the endpoint is currently active
                  in any snapshot
                type: boolean
              clusters:
                description: Clusters is a comma-separated list of cluster names where
                  this endpoint is deployed
                type: string
              conditions:
                description: Conditions represent the latest available observations
                  of the endpoint's state
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              endpointCount:
                description: EndpointCount is the total number of lb_endpoints in
                  this resource
                type: integer
              lastReconciled:
                description: LastReconciled is the last time the endpoint was successfully
                  reconciled
                format: date-time
                type: string
              message:
                description: Message provides additional information about the current
                  state
                type: string
              nodes:
                description: Nodes is a comma-separated list of node IDs where this
                  endpoint is deployed
                type: string
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                  by the controller
                format: int64
                type: integer
              referencedBy:
                description: ReferencedBy is a comma-separated list of Cluster resources
                  that reference this endpoint
                type: string
              snapshots:
                description: Snapshots contains information about snapshots where
                  this endpoint exists
                items:
                  description: SnapshotInfo contains information about a snapshot
                    where the resource exists
                  properties:
                    active:
                      description: Active indicates if the resource is active in this
                        snapshot
                      type: boolean
                    cluster:
                      description: Cluster is the Envoy cluster name
                      type: string
                    lastUpdated:
                      description: LastUpdated is when this snapshot was last updated
                      format: date-time
                      type: string
                    nodeId:
                      description: NodeID is the Envoy node identifier
                      type: string
                    version:
                      description: Version is the snapshot version hash
                      type: string
                  required:
                  - active
                  - nodeId
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.4
  name: tlssecrets.envoyxds.io
spec:
  group: envoyxds.io
  names:
    kind: TLSSecret
    listKind: TLSSecretList
    plural: tlssecrets
    singular: tlssecret
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Whether the secret is active
      jsonPath: .status.active
      name: Active
      type: boolean
    - description: Status message
      jsonPath: .status.message
      name: Status
      type: string
    - description: Certificate issuer
      jsonPath: .status.certificateInfo.issuer
      name: Issuer
      type: string
    - description: Certificate expiration
      jsonPath: .status.certificateInfo.notAfter
      name: Expires
      type: string
    - description: Days until expiry
      jsonPath: .status.certificateInfo.daysUntilExpiry
      name: Days
      type: integer
    - description: Nodes where secret is deployed
      jsonPath: .status.nodes
      name: Nodes
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: TLSSecret is the Schema for the tlssecrets API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: TLSSecretSpec defines the desired state of TLSSecret
            properties:
              challenge:
                properties:
                  acme_env:
                    type: string
                  challenge_type:
                    type: string
                  custom_dns01_env_replace:
                    description: |-
                      env vars pairs for DNS01Provider, for example: MY_OTHER_ACCOUNT_API_KEY, CLOUDFLARE_API_KEY
                      when DNS01 provider will be used, it will temporary assing the first value of the first ENV variable to the second env var value, TEMPORARY
                      the first env variable in pair should be assigned globally
                    items:
                      type: string
                    type: array
                  dns01_provider:
                    type: string
                type: object
              config:
                properties:
                  kubernetes_config:
                    properties:
                      namespace:
                        description: |-
                          Namespace is the Kubernetes namespace where the secret will be stored
                          If empty, uses the same namespace as the TLSSecret resource
                        type: string
                      secret_name:
                        description: |-
                          SecretName is the name of the Kubernetes Secret to store the certificate
                          If empty, uses the TLSSecret resource name
                        type: string
                    type: object
                  local_config:
                    properties:
                      base64_ca_cert:
                        type: string
                      base64_ca_key:
                        type: string
                      expire_after_days:
                        type: integer
                      path:
                        type: string
                    type: object
                  type:
                    type: string
                  vault_config:
                    properties:
                      path:
                        type: string
                      skip_tls_verify:
                        type: boolean
                      token:
                        type: string
                      url:
                        type: string
                    type: object
                type: object
              domains:
                items:
                  type: string
                type: array
              secret_name:
                type: string
            required:
            - domains
            type: object
          status:
            description: TLSSecretStatus defines the observed state of TLSSecret
            properties:
              active:
                description: Active indicates if the secret is currently active in
                  any snapshot
                type: boolean
              certificateInfo:
                description: CertificateInfo contains information about the TLS certificate
                properties:
                  daysUntilExpiry:
                    description: DaysUntilExpiry is the number of days until the certificate
                      expires
                    type: integer
                  dnsNames:
                    description: DNSNames are the DNS names in the certificate
                    items:
                      type: string
                    type: array
                  fingerprint:
                    description: Fingerprint is the SHA256 fingerprint of the certificate
                    type: string
                  issuer:
                    description: Issuer is the certificate issuer (e.g., "Let's Encrypt",
                      "Self-Signed", "Vault")
                    type: string
                  notAfter:
                    description: NotAfter is when the certificate expires
                    format: date-time
                    type: string
                  notBefore:
                    description: NotBefore is when the certificate becomes valid
                    format: date-time
                    type: string
                  serialNumber:
                    description: SerialNumber is the certificate serial number
                    type: string
                  subject:
                    description: Subject is the certificate subject (CN)
                    type: string
                type: object
              clusters:
                description: Clusters is a comma-separated list of cluster names where
                  this secret is deployed
                type: string
              conditions:
                description: Conditions represent the latest available observations
                  of the secret's state
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              lastReconciled:
                description: LastReconciled is the last time the secret was successfully
                  reconciled
                format: date-time
                type: string
              message:
                description: Message provides additional information about the current
                  state
                type: string
              nextRenewal:
                description: NextRenewal is when the certificate will be renewed
                type: string
              nodes:
                description: Nodes is a comma-separated list of node IDs where this
                  secret is deployed
                type: string
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                  by the controller
                format: int64
                type: integer
              snapshots:
                description: Snapshots contains information about snapshots where
                  this secret exists
                items:
                  description: SnapshotInfo contains information about a snapshot
                    where the resource exists
                  properties:
                    active:
                      description: Active indicates if the resource is active in this
                        snapshot
                      type: boolean
                    cluster:
                      description: Cluster is the Envoy cluster name
                      type: string
                    lastUpdated:
                      description: LastUpdated is when this snapshot was last updated
                      format: date-time
                      type: string
                    nodeId:
                      description: NodeID is the Envoy node identifier
                      type: string
                    version:
                      description: Version is the snapshot version hash
                      type: string
                  required:
                  - active
                  - nodeId
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
